import knex from '../database/connections';
import {Request, Response} from 'express';


class PointsController{
   async index(request:Request, response:Response){
      const {id} =request.params;

      const point = await knex('points').where('id', id).first();

      if(!point){
          return response.status(400).json({message: 'Not found'});
      }

      const items = await knex('items').join('point_items', 'items.id', '=', 'point_items.item_id')
      .where('point_items.point_id', id).select('items.title');

    return response.json({point, items});         
   }

   async duff(request:Request, response:Response){
          const {city, uf, items} = request.query;
         
          const parsedItems = String(items).split(',').map(item => Number(item.trim()));

          const points = await knex('points').join('point_items', 'points.id', '=', 'point_items.point_id')
            .whereIn('point_items.item_id', parsedItems)
            .where('city', String(city))
            .where('uf', String(uf))
            .distinct()
            .select('points.*');

          return response.json(points);
       }

   async create(request: Request,response:Response){
      const {
          name,
          email,
          whatsapp,
          latitude,
          longitude,
          city,
          uf,
          items  
          } = request.body;
                
     const trx = await knex.transaction();
     const point = {
          image: 'data:image/png;base64,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',
          name,
          email,
          whatsapp,
          latitude,
          longitude,
          city,
          uf        
          };

     const insertIds = await trx('points').insert(point);
     const point_id = insertIds[0];
     const pointItems = items.map((item_id: number)=>{
       return{
          item_id,
          point_id,
           };
          })
                
     await trx('point_items').insert(pointItems);
      
     await trx.commit();

     return response.json({
          id: point_id,
          ...point,
     });
  };
}

export default PointsController;